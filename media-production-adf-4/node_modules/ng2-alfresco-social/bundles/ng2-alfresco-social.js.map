{"version":3,"file":"./bundles/ng2-alfresco-social.js","sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 4c8f91ed24de8ff70dff","webpack:///external \"@angular/core\"","webpack:///./src/services/rating.service.ts","webpack:///./src/components/like.component.ts","webpack:///./src/components/rating.component.ts","webpack:///external \"ng2-alfresco-core\"","webpack:///./src/material.module.ts","webpack:///./src/components/like.component.html","webpack:///./src/components/rating.component.html","webpack:///./src/components/like.component.scss","webpack:///./src/components/rating.component.scss","webpack:///./src/components/like.component.scss?fa57","webpack:///./src/components/rating.component.scss?eadb","webpack:///external \"@angular/material\"","webpack:///external \"rxjs/Rx\"","webpack:///./index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@angular/core\"), require(\"ng2-alfresco-core\"), require(\"@angular/material\"), require(\"rxjs/Rx\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"@angular/core\", \"ng2-alfresco-core\", \"@angular/material\", \"rxjs/Rx\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ng2-alfresco-social\"] = factory(require(\"@angular/core\"), require(\"ng2-alfresco-core\"), require(\"@angular/material\"), require(\"rxjs/Rx\"));\n\telse\n\t\troot[\"ng2-alfresco-social\"] = factory(root[\"@angular/core\"], root[\"ng2-alfresco-core\"], root[\"@angular/material\"], root[\"rxjs/Rx\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_4__, __WEBPACK_EXTERNAL_MODULE_12__, __WEBPACK_EXTERNAL_MODULE_13__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4c8f91ed24de8ff70dff","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@angular/core\"\n// module id = 0\n// module chunks = 0","/*!\n * @license\n * Copyright 2016 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { Response } from '@angular/http';\nimport { RatingBody } from 'alfresco-js-api';\nimport { AlfrescoApiService } from 'ng2-alfresco-core';\nimport { Observable } from 'rxjs/Rx';\n\n@Injectable()\nexport class RatingService {\n\n    constructor(private apiService: AlfrescoApiService) {\n    }\n\n    getRating(nodeId: string, ratingType: any): any {\n        return Observable.fromPromise(this.apiService.getInstance().core.ratingsApi.getRating(nodeId, ratingType))\n            .map(res => res)\n            .catch(this.handleError);\n    }\n\n    postRating(nodeId: string, ratingType: any, vote: any): any {\n        let ratingBody: RatingBody = {\n            'id': ratingType,\n            'myRating': vote\n        };\n        return Observable.fromPromise(this.apiService.getInstance().core.ratingsApi.rate(nodeId, ratingBody))\n            .map(res => res)\n            .catch(this.handleError);\n    }\n\n    deleteRating(nodeId: string, ratingType: any): any {\n        return Observable.fromPromise(this.apiService.getInstance().core.ratingsApi.removeRating(nodeId, ratingType))\n            .map(res => res)\n            .catch(this.handleError);\n    }\n\n    private handleError(error: Response): any {\n        console.error(error);\n        return Observable.throw(error || 'Server error');\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/rating.service.ts","/*!\n * @license\n * Copyright 2016 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Input, OnChanges, Output, ViewEncapsulation } from '@angular/core';\nimport { RatingService } from './../services/rating.service';\n\n@Component({\n    selector: 'adf-like',\n    styles: [require('./like.component.scss')],\n    template: require('./like.component.html'),\n    providers: [RatingService],\n    encapsulation: ViewEncapsulation.None\n})\nexport class LikeComponent implements OnChanges {\n\n    @Input()\n    nodeId: string;\n\n    likesCounter: number = 0;\n\n    ratingType: string = 'likes';\n\n    isLike: boolean = false;\n\n    @Output()\n    changeVote = new EventEmitter();\n\n    constructor(private ratingService: RatingService) {\n    }\n\n    ngOnChanges() {\n        this.clean();\n\n        let ratingObserver = this.ratingService.getRating(this.nodeId, this.ratingType);\n\n        ratingObserver.subscribe(\n            (data) => {\n                if (data.entry.aggregate) {\n                    this.likesCounter = data.entry.aggregate.numberOfRatings;\n                    if (data.entry.ratedAt) {\n                        this.isLike = true;\n                    }\n                }\n            }\n        );\n\n        return ratingObserver;\n    }\n\n    likeClick() {\n        if (this.isLike) {\n            this.ratingService.deleteRating(this.nodeId, this.ratingType).subscribe(\n                () => {\n                    this.likesCounter -= 1;\n                    this.isLike = false;\n                }\n            );\n        } else {\n            this.ratingService.postRating(this.nodeId, this.ratingType, true).subscribe(\n                (data) => {\n                    this.likesCounter = data.entry.aggregate.numberOfRatings;\n                    this.isLike = true;\n                }\n            );\n        }\n\n        this.changeVote.emit(this.likesCounter);\n    }\n\n    clean() {\n        this.isLike = false;\n        this.likesCounter = 0;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/like.component.ts","/*!\n * @license\n * Copyright 2016 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Input, OnChanges, Output, ViewEncapsulation } from '@angular/core';\nimport { RatingService } from './../services/rating.service';\n\n@Component({\n    selector: 'adf-rating',\n    styles: [require('./rating.component.scss')],\n    template: require('./rating.component.html'),\n    providers: [RatingService],\n    encapsulation: ViewEncapsulation.None\n})\nexport class RatingComponent implements OnChanges {\n\n    @Input()\n    nodeId: string;\n\n    average: number = 0;\n\n    ratingType: string = 'fiveStar';\n\n    @Output()\n    changeVote = new EventEmitter();\n\n    stars: Array<any> = [];\n\n    constructor(private ratingService: RatingService) {\n    }\n\n    ngOnChanges() {\n        let ratingObserver = this.ratingService.getRating(this.nodeId, this.ratingType);\n\n        ratingObserver.subscribe(\n            (data) => {\n                if (data.entry.aggregate) {\n                    this.average = data.entry.aggregate.average;\n                    this.calculateStars();\n                }\n            }\n        );\n\n        return ratingObserver;\n    }\n\n    calculateStars() {\n        this.stars = [];\n\n        for (let i = 0; i < 5; i++) {\n            if (i < this.average) {\n                this.stars.push({fill: true});\n            } else {\n                this.stars.push({fill: false});\n            }\n        }\n\n        this.changeVote.emit(this.average);\n    }\n\n    updateVote(vote: number) {\n        this.ratingService.postRating(this.nodeId, this.ratingType, vote).subscribe(\n            (data) => {\n                if (data.entry.aggregate) {\n                    if (this.average !== data.entry.aggregate.average) {\n                        this.average = data.entry.aggregate.average;\n                        this.calculateStars();\n                    }\n                }\n            }\n        );\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/rating.component.ts","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ng2-alfresco-core\"\n// module id = 4\n// module chunks = 0","/*!\n * @license\n * Copyright 2016 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NgModule } from '@angular/core';\nimport {\n    MdIconModule,\n    MdListModule\n} from '@angular/material';\n\nexport function modules() {\n    return [\n        MdIconModule,\n        MdListModule\n    ];\n}\n\n@NgModule({\n    imports: modules(),\n    exports: modules()\n})\nexport class MaterialModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/material.module.ts","module.exports = \"<div id=\\\"adf-like-container\\\" class=\\\"adf-like-container\\\">\\n    <div class=\\\"adf-like\\\">\\n        <span id=\\\"adf-like-{{nodeId}}\\\" [ngClass]=\\\"{'adf-like-select': isLike ,'adf-like-grey': !isLike  }\\\"\\n              (click)=\\\"likeClick()\\\">\\n            <md-icon>thumb_up</md-icon>\\n        </span>\\n    </div>\\n    <div id=\\\"adf-like-counter\\\" class=\\\"adf-like-counter\\\">{{likesCounter}}</div>\\n    <div class=\\\"adf-left\\\" *ngIf=\\\"likesCounter<=1\\\">Like</div>\\n    <div class=\\\"adf-left\\\" *ngIf=\\\"likesCounter>1\\\">Likes</div>\\n</div>\\n\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/like.component.html\n// module id = 6\n// module chunks = 0","module.exports = \"<md-list id=\\\"adf-rating-container\\\" class=\\\"adf-rating-container\\\">\\n    <md-list-item class=\\\"adf-rating-star\\\" *ngFor=\\\"let currentRate of stars; let idx = index\\\">\\n            <span id=\\\"adf-rate-{{idx}}\\\">\\n                <md-icon id=\\\"adf-grey-star-{{idx}}\\\" *ngIf=\\\"currentRate.fill\\\" class=\\\"adf-colored-star\\\"\\n                         (click)=\\\"updateVote(idx + 1)\\\">star_rate\\n                </md-icon>\\n                <md-icon id=\\\"adf-colored-star-{{idx}}\\\" *ngIf=\\\"!currentRate.fill\\\" class=\\\"adf-grey-star\\\"\\n                         (click)=\\\"updateVote(idx + 1)\\\">star_border\\n                </md-icon>\\n            </span>\\n    </md-list-item>\\n</md-list>\\n\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/rating.component.html\n// module id = 7\n// module chunks = 0","module.exports = \".adf-like-container {\\n  overflow: hidden;\\n  width: 100%; }\\n  .adf-like-container .adf-like {\\n    padding: 5px;\\n    cursor: pointer;\\n    float: left;\\n    margin: 5px 0px 5px 5px; }\\n  .adf-like-container .adf-like-select {\\n    cursor: pointer;\\n    color: #2196f3; }\\n  .adf-like-container .adf-like-select:hover {\\n    cursor: pointer;\\n    color: #808080; }\\n  .adf-like-container .adf-like-grey {\\n    cursor: pointer;\\n    color: #808080; }\\n  .adf-like-container .adf-like-grey:hover {\\n    cursor: pointer;\\n    color: #2196f3; }\\n  .adf-like-container .adf-like-counter {\\n    float: left;\\n    padding: 13px 0 0 0; }\\n  .adf-like-container .adf-left {\\n    float: left;\\n    padding: 13px 0 0 4px; }\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./~/sass-loader/lib/loader.js!./src/components/like.component.scss\n// module id = 8\n// module chunks = 0","module.exports = \".adf-rating-container {\\n  overflow: hidden;\\n  width: 100%; }\\n  .adf-rating-container .adf-rating-star {\\n    float: left;\\n    transition: all .3s;\\n    padding: 1px;\\n    cursor: pointer; }\\n    .adf-rating-container .adf-rating-star .mat-list-item-content {\\n      padding: 0 2px !important; }\\n  .adf-rating-container .adf-colored-star {\\n    color: #ffe944; }\\n  .adf-rating-container .adf-grey-star {\\n    color: #808080; }\\n  .adf-rating-container .adf-stars-container {\\n    padding: 0 !important;\\n    margin: 0 !important;\\n    display: inline-block; }\\n  .adf-rating-container .adf-rating-star:hover {\\n    transform: rotate(13deg) scale(1.2); }\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./~/sass-loader/lib/loader.js!./src/components/rating.component.scss\n// module id = 9\n// module chunks = 0","\n        var result = require(\"!!../../node_modules/raw-loader/index.js!../../node_modules/sass-loader/lib/loader.js!./like.component.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    \n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/like.component.scss\n// module id = 10\n// module chunks = 0","\n        var result = require(\"!!../../node_modules/raw-loader/index.js!../../node_modules/sass-loader/lib/loader.js!./rating.component.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    \n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/rating.component.scss\n// module id = 11\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_12__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@angular/material\"\n// module id = 12\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_13__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"rxjs/Rx\"\n// module id = 13\n// module chunks = 0","/*!\n * @license\n * Copyright 2016 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NgModule } from '@angular/core';\nimport { CoreModule } from 'ng2-alfresco-core';\n\nimport { LikeComponent } from './src/components/like.component';\nimport { RatingComponent } from './src/components/rating.component';\nimport { MaterialModule } from './src/material.module';\nimport { RatingService } from './src/services/rating.service';\n\nexport * from './src/components/rating.component';\nexport * from './src/components/like.component';\nexport * from './src/services/rating.service';\n\nexport const RATING_DIRECTIVES: any[] = [\n    RatingComponent,\n    LikeComponent\n];\n\nexport const RATING_PROVIDERS: any[] = [\n    RatingService\n];\n\n@NgModule({\n    imports: [\n        CoreModule,\n        MaterialModule\n    ],\n    declarations: [\n        ...RATING_DIRECTIVES\n    ],\n    providers: [\n        ...RATING_PROVIDERS\n    ],\n    exports: [\n        ...RATING_DIRECTIVES\n    ]\n})\nexport class SocialModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./index.ts"],"mappings":";;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AChEA;;;;;;;;ACAA;;;;;;;;;;;;;;;AAeA;;;;;;;;;;;AAEA;AAGA;AACA;AAGA;AAEA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AA9BA;AADA;AAGA;AAFA;AA+BA;;AAAA;AA/BA;;;;;;;;;ACxBA;;;;;;;;;;;;;;;AAeA;;;;;;;;;;;AAEA;AACA;AASA;AAcA;AAAA;AATA;AAEA;AAEA;AAGA;AAGA;AAEA;AAAA;AACA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AAAA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAAA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAxDA;AADA;;AACA;AASA;AADA;;AACA;AAZA;AAPA;AACA;AACA;AACA;AACA;AACA;AACA;AAeA;AAdA;AA4DA;;AAAA;AA5DA;;;;;;;;;AC3BA;;;;;;;;;;;;;;;AAeA;;;;;;;;;;;AAEA;AACA;AASA;AAcA;AAAA;AATA;AAEA;AAGA;AAEA;AAGA;AAEA;AAAA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAtDA;AADA;;AACA;AAOA;AADA;;AACA;AAVA;AAPA;AACA;AACA;AACA;AACA;AACA;AACA;AAeA;AAdA;AA0DA;;AAAA;AA1DA;;;;;;;AC3BA;;;;;;;;ACAA;;;;;;;;;;;;;;;AAeA;;;;;;;;AAEA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AALA;AAWA;AAAA;AAAA;AAAA;AAJA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;;;;;;;AClCA;;;;;;ACAA;;;;;;ACAA;;;;;;ACAA;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;ACRA;;;;;;ACAA;;;;;;;;ACAA;;;;;;;;;;;;;;;AAeA;;;;;;;;;;;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAiBA;AAAA;AAAA;AAAA;AAfA;AACA;AACA;AACA;AACA;AACA;AAGA;AAGA;AAGA;AACA;AAAA;AAAA;AAAA;;;;;","sourceRoot":""}